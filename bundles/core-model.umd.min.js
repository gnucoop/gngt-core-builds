/**
 * @license
 * Copyright (C) 2018 Gnucoop soc. coop.
 *
 * This file is part of the Gnucoop Angular Toolkit (gngt).
 *
 * Gnucoop Angular Toolkit (gngt) is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * Gnucoop Angular Toolkit (gngt) is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with Gnucoop Angular Toolkit (gngt).  If not, see http://www.gnu.org/licenses/.
 *
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@gngt/core/reducers"),require("rxjs"),require("rxjs/operators"),require("@ngrx/effects"),require("uuid"),require("@angular/common/http"),require("@angular/core"),require("@gngt/core/common"),require("@gngt/core/sync"),require("@ngrx/store")):"function"==typeof define&&define.amd?define("@gngt/core/model",["exports","@gngt/core/reducers","rxjs","rxjs/operators","@ngrx/effects","uuid","@angular/common/http","@angular/core","@gngt/core/common","@gngt/core/sync","@ngrx/store"],e):e(((t=t||self).gngt=t.gngt||{},t.gngt.core=t.gngt.core||{},t.gngt.core.model={}),t.gngt.core.reducers,t.rxjs,t.rxjs.operators,t.ngrx.effects,t.uuid,t.ng.common.http,t.ng.core,t.gngt.core.common,t.gngt.core.sync,t.ngrx.store)}(this,function(t,e,o,u,a,r,n,i,c,s,l){"use strict";var p=function(t,e){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function d(t,e){function r(){this.constructor=t}p(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var S=function(){return(S=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function f(t){this.payload=t}var y,h=(d(_,y=f),_);function _(t){var e=y.call(this,t)||this;return e.payload=t,e}var E,g=(d(m,E=f),m);function m(t){var e=E.call(this,t)||this;return e.payload=t,e}var T,A=(d(L,T=f),L);function L(t){var e=T.call(this,t)||this;return e.payload=t,e}var U,C=(d(v,U=f),v);function v(t){var e=U.call(this,t)||this;return e.payload=t,e}var b,j=(d(D,b=f),D);function D(t){var e=b.call(this,t)||this;return e.payload=t,e}var I,R=(d(M,I=f),M);function M(t){var e=I.call(this,t)||this;return e.payload=t,e}var P,F=(d(O,P=f),O);function O(t){var e=P.call(this,t)||this;return e.payload=t,e}var x,Q=(d(q,x=f),q);function q(t){var e=x.call(this,t)||this;return e.payload=t,e}var G,w=(d(H,G=f),H);function H(t){var e=G.call(this,t)||this;return e.payload=t,e}var Y,$=(d(N,Y=f),N);function N(t){var e=Y.call(this,t)||this;return e.payload=t,e}var k,z=(d(B,k=f),B);function B(t){var e=k.call(this,t)||this;return e.payload=t,e}var J,K=(d(V,J=f),V);function V(t){var e=J.call(this,t)||this;return e.payload=t,e}var W,X=(d(Z,W=f),Z);function Z(t){var e=W.call(this,t)||this;return e.payload=t,e}var tt,et=(d(rt,tt=f),rt);function rt(t){var e=tt.call(this,t)||this;return e.payload=t,e}var nt,it=(d(ot,nt=f),ot);function ot(t){var e=nt.call(this,t)||this;return e.payload=t,e}var ut,at=(d(ct,ut=f),ct);function ct(t){var e=ut.call(this,t)||this;return e.payload=t,e}var st,lt=(d(pt,st=f),pt);function pt(t){var e=st.call(this,t)||this;return e.payload=t,e}var dt,ft=(d(yt,dt=f),yt);function yt(t){var e=dt.call(this,t)||this;return e.payload=t,e}var ht,_t=(d(Et,ht=f),Et);function Et(t){var e=ht.call(this,t)||this;return e.payload=t,e}var gt,St=(d(mt,gt=f),mt);function mt(t){var e=gt.call(this,t)||this;return e.payload=t,e}var Tt,At=(d(Lt,Tt=f),Lt);function Lt(t){var e=Tt.call(this,t)||this;return e.payload=t,e}var Ut,Ct=(d(vt,Ut=f),vt);function vt(t){var e=Ut.call(this,t)||this;return e.payload=t,e}var bt,jt=(d(Dt,bt=f),Dt);function Dt(t){var e=bt.call(this,t)||this;return e.payload=t,e}var It,Rt=(d(Mt,It=f),Mt);function Mt(t){var e=It.call(this,t)||this;return e.payload=t,e}var Pt=Object.freeze({ModelActionTypes:function(){},generateModelActionTypes:function(t){return{LIST:e.type("["+t+"] List"),LIST_FAILURE:e.type("["+t+"] List failure"),LIST_SUCCESS:e.type("["+t+"] List success"),GET:e.type("["+t+"] Get"),GET_FAILURE:e.type("["+t+"] Get failure"),GET_SUCCESS:e.type("["+t+"] Get success"),CREATE:e.type("["+t+"] Create"),CREATE_FAILURE:e.type("["+t+"] Create failure"),CREATE_SUCCESS:e.type("["+t+"] Create success"),UPDATE:e.type("["+t+"] Update"),UPDATE_FAILURE:e.type("["+t+"] Update failure"),UPDATE_SUCCESS:e.type("["+t+"] Update success"),PATCH:e.type("["+t+"] Patch"),PATCH_FAILURE:e.type("["+t+"] Patch failure"),PATCH_SUCCESS:e.type("["+t+"] Patch success"),DELETE:e.type("["+t+"] Delete"),DELETE_FAILURE:e.type("["+t+"] Delete failure"),DELETE_SUCCESS:e.type("["+t+"] Delete success"),DELETE_ALL:e.type("["+t+"] Delete all"),DELETE_ALL_FAILURE:e.type("["+t+"] Delete all failure"),DELETE_ALL_SUCCESS:e.type("["+t+"] Delete all success"),QUERY:e.type("["+t+"] Query"),QUERY_FAILURE:e.type("["+t+"] Query failure"),QUERY_SUCCESS:e.type("["+t+"] Query success")}},ModelBaseAction:f,ModelGetAction:h,ModelGetSuccessAction:g,ModelGetFailureAction:A,ModelListAction:C,ModelListSuccessAction:j,ModelListFailureAction:R,ModelCreateAction:F,ModelCreateSuccessAction:Q,ModelCreateFailureAction:w,ModelUpdateAction:$,ModelUpdateSuccessAction:z,ModelUpdateFailureAction:K,ModelPatchAction:X,ModelPatchSuccessAction:et,ModelPatchFailureAction:it,ModelDeleteAction:at,ModelDeleteSuccessAction:lt,ModelDeleteFailureAction:ft,ModelDeleteAllAction:_t,ModelDeleteAllSuccessAction:St,ModelDeleteAllFailureAction:At,ModelQueryAction:Ct,ModelQuerySuccessAction:jt,ModelQueryFailureAction:Rt});function Ft(){return{get:[],list:[],create:[],update:[],patch:[],delete:[],deleteAll:[],query:[]}}function Ot(t,e,r){switch(e.type){case r.GET:return S({},t,{get:[{uuid:e.uuid,loading:!0,options:{id:null},id:e.payload.id,object:null,error:null}].concat(t.get.slice(0,19))});case r.GET_SUCCESS:var n=t.get.findIndex(function(t){return t.uuid===e.uuid});return 0<=n?S({},t,{get:t.get.slice(0,n).concat([S({},t.get[n],{loading:!1,object:e.payload.item,error:null})],t.get.slice(n+1))}):t;case r.GET_FAILURE:var i=t.get.findIndex(function(t){return t.uuid===e.uuid});return 0<=i?S({},t,{get:t.get.slice(0,i).concat([S({},t.get[i],{loading:!1,object:null,error:e.payload.error})],t.get.slice(i+1))}):t;case r.LIST:return S({},t,{list:[{uuid:e.uuid,loading:!0,options:e.payload.params,objects:null,error:null}].concat(t.list.slice(0,19))});case r.LIST_SUCCESS:var o=t.list.findIndex(function(t){return t.uuid===e.uuid});return 0<=o?S({},t,{list:t.list.slice(0,o).concat([S({},t.list[o],{loading:!1,objects:e.payload.result,error:null})],t.list.slice(o+1))}):t;case r.LIST_FAILURE:var u=t.list.findIndex(function(t){return t.uuid===e.uuid});return 0<=u?S({},t,{list:t.list.slice(0,u).concat([S({},t.list[u],{loading:!1,objects:null,error:e.payload.error})],t.list.slice(u+1))}):t;case r.CREATE:return S({},t,{create:[{uuid:e.uuid,loading:!0,object:e.payload.item,error:null}].concat(t.create.slice(0,19))});case r.CREATE_SUCCESS:var a=t.create.findIndex(function(t){return t.uuid===e.uuid});return 0<=a?S({},t,{create:t.create.slice(0,a).concat([S({},t.create[a],{loading:!1,object:e.payload.item,error:null})],t.create.slice(a+1))}):t;case r.CREATE_FAILURE:var c=t.create.findIndex(function(t){return t.uuid===e.uuid});return 0<=c?S({},t,{create:t.create.slice(0,c).concat([S({},t.create[c],{loading:!1,object:null,error:e.payload.error})],t.create.slice(c+1))}):t;case r.UPDATE:return S({},t,{update:[{uuid:e.uuid,loading:!0,id:e.payload.item.id,object:e.payload.item,error:null}].concat(t.update.slice(0,19))});case r.UPDATE_SUCCESS:var s=t.update.findIndex(function(t){return t.uuid===e.uuid});return 0<=s?S({},t,{update:t.update.slice(0,s).concat([S({},t.update[s],{loading:!1,object:e.payload.item,error:null})],t.update.slice(s+1))}):t;case r.UPDATE_FAILURE:var l=t.update.findIndex(function(t){return t.uuid===e.uuid});return 0<=l?S({},t,{update:t.update.slice(0,l).concat([S({},t.update[l],{loading:!1,object:null,error:e.payload.error})],t.update.slice(l+1))}):t;case r.PATCH:return S({},t,{patch:[{uuid:e.uuid,loading:!0,id:e.payload.item.id,object:e.payload.item,error:null}].concat(t.patch.slice(0,19))});case r.PATCH_SUCCESS:var p=t.patch.findIndex(function(t){return t.uuid===e.uuid});return 0<=p?S({},t,{patch:t.patch.slice(0,p).concat([S({},t.patch[p],{loading:!1,object:e.payload.item,error:null})],t.patch.slice(p+1))}):t;case r.PATCH_FAILURE:var d=t.patch.findIndex(function(t){return t.uuid===e.uuid});return 0<=d?S({},t,{patch:t.patch.slice(0,d).concat([S({},t.patch[d],{loading:!1,object:null,error:e.payload.error})],t.patch.slice(d+1))}):t;case r.DELETE:return S({},t,{delete:[{uuid:e.uuid,loading:!0,id:e.payload.item.id,object:null,error:null}].concat(t.delete.slice(0,19))});case r.DELETE_SUCCESS:var f=t.delete.findIndex(function(t){return t.uuid===e.uuid});return 0<=f?S({},t,{delete:t.delete.slice(0,f).concat([S({},t.delete[f],{loading:!1,object:e.payload.item,error:null})],t.delete.slice(f+1))}):t;case r.DELETE_FAILURE:var y=t.delete.findIndex(function(t){return t.uuid===e.uuid});return 0<=y?S({},t,{delete:t.delete.slice(0,y).concat([S({},t.delete[y],{loading:!1,object:null,error:e.payload.error})],t.delete.slice(y+1))}):t;case r.DELETE_ALL:return S({},t,{deleteAll:[{uuid:e.uuid,loading:!0,ids:e.payload.items.map(function(t){return t.id}),objects:null,error:null}].concat(t.deleteAll.slice(0,19))});case r.DELETE_ALL_SUCCESS:var h=t.deleteAll.findIndex(function(t){return t.uuid===e.uuid});return 0<=h?S({},t,{deleteAll:t.deleteAll.slice(0,h).concat([S({},t.deleteAll[h],{loading:!1,objects:e.payload.items,error:null})],t.deleteAll.slice(h+1))}):t;case r.DELETE_ALL_FAILURE:var _=t.deleteAll.findIndex(function(t){return t.uuid===e.uuid});return 0<=_?S({},t,{deleteAll:t.deleteAll.slice(0,_).concat([S({},t.deleteAll[_],{loading:!1,objects:null,error:e.payload.error})],t.deleteAll.slice(_+1))}):t;case r.QUERY:return S({},t,{query:[{uuid:e.uuid,loading:!0,options:e.payload.params,objects:null,error:null}].concat(t.query.slice(0,19))});case r.QUERY_SUCCESS:var E=t.query.findIndex(function(t){return t.uuid===e.uuid});return 0<=E?S({},t,{query:t.query.slice(0,E).concat([S({},t.query[E],{loading:!1,options:S({},t.query[E].options),objects:e.payload.result,error:null})],t.query.slice(E+1))}):t;case r.QUERY_FAILURE:var g=t.query.findIndex(function(t){return t.uuid===e.uuid});return 0<=g?S({},t,{query:t.query.slice(0,g).concat([S({},t.query[g],{loading:!1,options:S({},t.query[g].options),objects:null,error:e.payload.error})],t.query.slice(g+1))}):t;default:return t}}var xt=Object.freeze({ModelPackageState:function(){},generateInitialModelState:Ft,modelReducer:Ot}),Qt=function(t){this.payload=t};function qt(t){var e=new Qt(t.payload);return e.type=t.type,e.uuid=t.uuid||r.v4(),e}function Gt(t,e,r,n){var i=this;this._actions=t,this._service=e,this._manager=r,this._actionTypes=n,this.modelGet$=a.createEffect(function(){return i._actions.pipe(a.ofType(i._actionTypes.GET),u.mergeMap(function(e){return i._manager.get(e.payload.id).pipe(u.map(function(t){return qt({type:i._actionTypes.GET_SUCCESS,payload:{item:t},uuid:e.uuid})}),u.catchError(function(t){return o.of(qt({type:i._actionTypes.GET_FAILURE,payload:{error:t},uuid:e.uuid}))}))}))}),this.modelList$=a.createEffect(function(){return i._actions.pipe(a.ofType(i._actionTypes.LIST),u.mergeMap(function(e){return i._manager.list(e.payload.params).pipe(u.map(function(t){return qt({type:i._actionTypes.LIST_SUCCESS,payload:{result:t},uuid:e.uuid})}),u.catchError(function(t){return o.of(qt({type:i._actionTypes.LIST_FAILURE,payload:{error:t},uuid:e.uuid}))}))}))}),this.modelCreate$=a.createEffect(function(){return i._actions.pipe(a.ofType(i._actionTypes.CREATE),u.mergeMap(function(e){return i._manager.create(e.payload.item).pipe(u.map(function(t){return qt({type:i._actionTypes.CREATE_SUCCESS,payload:{item:t},uuid:e.uuid})}),u.catchError(function(t){return o.of(qt({type:i._actionTypes.CREATE_FAILURE,payload:{error:t},uuid:e.uuid}))}))}))}),this.modelUpdate$=a.createEffect(function(){return i._actions.pipe(a.ofType(i._actionTypes.UPDATE),u.mergeMap(function(e){return i._manager.update(e.payload.item.id,e.payload.item).pipe(u.map(function(t){return qt({type:i._actionTypes.UPDATE_SUCCESS,payload:{item:t},uuid:e.uuid})}),u.catchError(function(t){return o.of(qt({type:i._actionTypes.CREATE_FAILURE,payload:{error:t},uuid:e.uuid}))}))}))}),this.modelPatch$=a.createEffect(function(){return i._actions.pipe(a.ofType(i._actionTypes.PATCH),u.mergeMap(function(e){return i._manager.patch(e.payload.item.id,e.payload.item).pipe(u.map(function(t){return qt({type:i._actionTypes.CREATE_SUCCESS,payload:{item:t},uuid:e.uuid})}),u.catchError(function(t){return o.of(qt({type:i._actionTypes.CREATE_FAILURE,payload:{error:t},uuid:e.uuid}))}))}))}),this.modelDelete$=a.createEffect(function(){return i._actions.pipe(a.ofType(i._actionTypes.DELETE),u.mergeMap(function(e){return i._manager.delete(e.payload.item.id).pipe(u.map(function(){return qt({type:i._actionTypes.DELETE_SUCCESS,payload:{item:e.payload.item},uuid:e.uuid})}),u.catchError(function(t){return o.of(qt({type:i._actionTypes.DELETE_FAILURE,payload:{error:t},uuid:e.uuid}))}))}))}),this.modelDeleteAll$=a.createEffect(function(){return i._actions.pipe(a.ofType(i._actionTypes.DELETE_ALL),u.mergeMap(function(e){return i._manager.deleteAll(e.payload.items.map(function(t){return t.id})).pipe(u.map(function(){return qt({type:i._actionTypes.DELETE_ALL_SUCCESS,payload:{items:e.payload.items},uuid:e.uuid})}),u.catchError(function(t){return o.of(qt({type:i._actionTypes.DELETE_ALL_FAILURE,payload:{error:t},uuid:e.uuid}))}))}))}),this.modelQuery$=a.createEffect(function(){return i._actions.pipe(a.ofType(i._actionTypes.QUERY),u.mergeMap(function(e){return i._manager.query(e.payload.params).pipe(u.map(function(t){return qt({type:i._actionTypes.QUERY_SUCCESS,payload:{result:t},uuid:e.uuid})}),u.catchError(function(t){return o.of(qt({type:i._actionTypes.QUERY_FAILURE,payload:{error:t},uuid:e.uuid}))}))}))})}var wt,Ht=(d(Yt,wt=c.ModelManager),Object.defineProperty(Yt.prototype,"endPoint",{get:function(){return this._endPoint},enumerable:!0,configurable:!0}),Object.defineProperty(Yt.prototype,"baseUrl",{get:function(){return this._baseUrl},enumerable:!0,configurable:!0}),Yt.prototype.get=function(t){return this._http.get(this._getObjectUrl(t))},Yt.prototype.list=function(t){var e=this._listParamsToQueryParameters(t);return this._http.get(""+this._getListUrl()+e)},Yt.prototype.create=function(t){return this._http.post(this._getListUrl(),t)},Yt.prototype.update=function(t,e){return this._http.put(this._getObjectUrl(t),e)},Yt.prototype.patch=function(t,e){return this._http.patch(this._getObjectUrl(t),e)},Yt.prototype.delete=function(t){return this._http.delete(this._getObjectUrl(t))},Yt.prototype.deleteAll=function(t){var e=this._baseUrl+"/delete_all";return this._useTrailingSlash&&(e+="/"),this._http.post(e,{ids:t})},Yt.prototype.query=function(t){var e=this._baseUrl+"/query";return this._useTrailingSlash&&(e+="/"),this._http.post(e,t)},Yt.prototype._getObjectUrl=function(t){var e=this._baseUrl+"/"+t;return this._useTrailingSlash&&(e+="/"),e},Yt.prototype._getListUrl=function(){var t=this._baseUrl;return this._useTrailingSlash&&(t+="/"),t},Yt.prototype._listParamsToQueryParameters=function(e){var t="",r=[];if(e){if(e.limit&&r.push("limit="+e.limit),e.start&&r.push("start="+e.start),e.sort){var n=Object.keys(e.sort);r.push("sort="+n.map(function(t){return t+":"+e.sort[t]}).join(","))}e.fields&&r.push("fields="+e.fields.join(",")),e.joins&&r.push("joins="+e.joins.map(function(t){var e=t.model+"."+t.property;return t.fields?e+"."+t.fields.join(";"):e}).join(",")),0<r.length&&(t="?"+r.join("&"))}return t},Yt.ctorParameters=function(){return[{type:void 0},{type:String},{type:n.HttpClient},{type:s.SyncService,decorators:[{type:i.Optional}]}]},Yt);function Yt(t,e,r,n){var i=wt.call(this)||this;if(i._endPoint=e,i._http=r,i._useTrailingSlash=!1,i._baseUrl=""+t.baseApiUrl+i._endPoint,i._useTrailingSlash=null!=t.addTrailingSlash&&t.addTrailingSlash,null!=n&&t.syncModel){if(null==t.tableName)throw new Error("Table name must be set for model "+i._endPoint);n.registerSyncModel(i._baseUrl,t.tableName)}return i}var $t=new i.InjectionToken("MODEL_OPTIONS",{providedIn:"root",factory:function(){return{baseApiUrl:"/"}}}),Nt=(kt.prototype.getGetLoading=function(){return this._store.pipe(this._lastGetEntry,u.map(function(t){return t.loading}))},kt.prototype.getGetOptions=function(){return this._store.pipe(this._lastGetEntry,u.map(function(t){return t.options}))},kt.prototype.getGetId=function(){return this._store.pipe(this._lastGetEntry,u.map(function(t){return t.id}))},kt.prototype.getGetObject=function(){return this._store.pipe(this._lastGetEntry,u.map(function(t){return t.object}))},kt.prototype.getGetError=function(){return this._store.pipe(this._lastGetEntry,u.map(function(t){return t.error}))},kt.prototype.getListLoading=function(){return this._store.pipe(this._lastListEntry,u.map(function(t){return t.loading}))},kt.prototype.getListOptions=function(){return this._store.pipe(this._lastListEntry,u.map(function(t){return t.options}))},kt.prototype.getListObjects=function(){return this._store.pipe(this._lastListEntry,u.map(function(t){return t.objects}))},kt.prototype.getListError=function(){return this._store.pipe(this._lastListEntry,u.map(function(t){return t.error}))},kt.prototype.getListHasNext=function(){return this._store.pipe(this._lastListEntry,u.filter(function(t){return null!=t.objects}),u.map(function(t){return t.objects.next}))},kt.prototype.getListCurrentStart=function(){return this._store.pipe(this._lastListEntry,u.filter(function(t){return null!=t.options}),u.map(function(t){return null!=t.options.start?t.options.start:1}))},kt.prototype.getCreateLoading=function(){return this._store.pipe(this._lastCreateEntry,u.map(function(t){return t.loading}))},kt.prototype.getCreateObject=function(){return this._store.pipe(this._lastCreateEntry,u.map(function(t){return t.object}))},kt.prototype.getCreateError=function(){return this._store.pipe(this._lastCreateEntry,u.map(function(t){return t.error}))},kt.prototype.getUpdateLoading=function(){return this._store.pipe(this._lastUpdateEntry,u.map(function(t){return t.loading}))},kt.prototype.getUpdateId=function(){return this._store.pipe(this._lastUpdateEntry,u.map(function(t){return t.id}))},kt.prototype.getUpdateObject=function(){return this._store.pipe(this._lastUpdateEntry,u.map(function(t){return t.object}))},kt.prototype.getUpdateError=function(){return this._store.pipe(this._lastUpdateEntry,u.map(function(t){return t.error}))},kt.prototype.getPatchLoading=function(){return this._store.pipe(this._lastPatchEntry,u.map(function(t){return t.loading}))},kt.prototype.getPatchId=function(){return this._store.pipe(this._lastPatchEntry,u.map(function(t){return t.id}))},kt.prototype.getPatchObject=function(){return this._store.pipe(this._lastPatchEntry,u.map(function(t){return t.object}))},kt.prototype.getPatchError=function(){return this._store.pipe(this._lastPatchEntry,u.map(function(t){return t.error}))},kt.prototype.getDeleteLoading=function(){return this._store.pipe(this._lastDeleteEntry,u.map(function(t){return t.loading}))},kt.prototype.getDeleteId=function(){return this._store.pipe(this._lastDeleteEntry,u.map(function(t){return t.id}))},kt.prototype.getDeleteObject=function(){return this._store.pipe(this._lastDeleteEntry,u.map(function(t){return t.object}))},kt.prototype.getDeleteError=function(){return this._store.pipe(this._lastDeleteEntry,u.map(function(t){return t.error}))},kt.prototype.getDeleteAllLoading=function(){return this._store.pipe(this._lastDeleteAllEntry,u.map(function(t){return t.loading}))},kt.prototype.getDeleteAllIds=function(){return this._store.pipe(this._lastDeleteAllEntry,u.map(function(t){return t.ids}))},kt.prototype.getDeleteAllObjects=function(){return this._store.pipe(this._lastDeleteAllEntry,u.map(function(t){return t.objects}))},kt.prototype.getDeleteAllError=function(){return this._store.pipe(this._lastDeleteAllEntry,u.map(function(t){return t.error}))},kt.prototype.getQueryLoading=function(){return this._store.pipe(this._lastQueryEntry,u.map(function(t){return t.loading}))},kt.prototype.getQueryOptions=function(){return this._store.pipe(this._lastQueryEntry,u.map(function(t){return t.options}))},kt.prototype.getQueryObjects=function(){return this._store.pipe(this._lastQueryEntry,u.map(function(t){return t.objects}))},kt.prototype.getQueryError=function(){return this._store.pipe(this._lastQueryEntry,u.map(function(t){return t.error}))},kt.prototype.getQueryHasNext=function(){return this._store.pipe(this._lastQueryEntry,u.filter(function(t){return null!=t.objects}),u.map(function(t){return t.objects.next}))},kt.prototype.getQueryCurrentStart=function(){return this._store.pipe(this._lastQueryEntry,u.filter(function(t){return null!=t.options}),u.map(function(t){return null!=t.options.start?t.options.start:1}))},kt.prototype.getCreateSuccess=function(){return this._actions.pipe(a.ofType(this._actionTypes.CREATE_SUCCESS))},kt.prototype.getUpdateSuccess=function(){return this._actions.pipe(a.ofType(this._actionTypes.UPDATE_SUCCESS))},kt.prototype.getPatchSuccess=function(){return this._actions.pipe(a.ofType(this._actionTypes.PATCH_SUCCESS))},kt.prototype.getDeleteSuccess=function(){return this._actions.pipe(a.ofType(this._actionTypes.DELETE_SUCCESS))},kt.prototype.getDeleteAllSuccess=function(){return this._actions.pipe(a.ofType(this._actionTypes.DELETE_ALL_SUCCESS))},kt.prototype.get=function(t){var e=this,r=qt({type:this._actionTypes.GET,payload:{id:t}});return this._store.dispatch(r),this._actions.pipe(a.ofType(this._actionTypes.GET_SUCCESS,this._actionTypes.GET_FAILURE),u.filter(function(t){return t.uuid===r.uuid})).pipe(u.switchMap(function(){return e._store}),l.select(l.createSelector(this._modelState,function(t){return t.get})),u.map(function(t){return t.find(function(t){return t.uuid===r.uuid})}),u.filter(function(t){return null!=t}),u.tap(function(t){null!=t.error&&o.throwError(t.error)}),u.filter(function(t){return null!=t.object}),u.map(function(t){return t.object}))},kt.prototype.list=function(t){var e=this,r=qt({type:this._actionTypes.LIST,payload:{params:t||{}}});return this._store.dispatch(r),this._actions.pipe(a.ofType(this._actionTypes.LIST_SUCCESS,this._actionTypes.LIST_FAILURE),u.filter(function(t){return t.uuid===r.uuid})).pipe(u.switchMap(function(){return e._store}),l.select(l.createSelector(this._modelState,function(t){return t.list})),u.map(function(t){return t.find(function(t){return t.uuid===r.uuid})}),u.filter(function(t){return null!=t}),u.tap(function(t){null!=t.error&&o.throwError(t.error)}),u.filter(function(t){return null!=t.objects}),u.map(function(t){return t.objects}))},kt.prototype.create=function(t){var e=this,r=qt({type:this._actionTypes.CREATE,payload:{item:t}});return this._store.dispatch(r),this._actions.pipe(a.ofType(this._actionTypes.CREATE_SUCCESS,this._actionTypes.CREATE_FAILURE),u.filter(function(t){return t.uuid===r.uuid})).pipe(u.switchMap(function(){return e._store}),l.select(l.createSelector(this._modelState,function(t){return t.create})),u.map(function(t){return t.find(function(t){return t.uuid===r.uuid})}),u.filter(function(t){return null!=t}),u.tap(function(t){null!=t.error&&o.throwError(t.error)}),u.filter(function(t){return null!=t.object}),u.map(function(t){return t.object}))},kt.prototype.update=function(t){var e=this,r=qt({type:this._actionTypes.UPDATE,payload:{item:t}});return this._store.dispatch(r),this._actions.pipe(a.ofType(this._actionTypes.UPDATE_SUCCESS,this._actionTypes.UPDATE_FAILURE),u.filter(function(t){return t.uuid===r.uuid})).pipe(u.switchMap(function(){return e._store}),l.select(l.createSelector(this._modelState,function(t){return t.update})),u.map(function(t){return t.find(function(t){return t.uuid===r.uuid})}),u.filter(function(t){return null!=t}),u.tap(function(t){null!=t.error&&o.throwError(t.error)}),u.filter(function(t){return null!=t.object}),u.map(function(t){return t.object}))},kt.prototype.patch=function(t){var e=this,r=qt({type:this._actionTypes.PATCH,payload:{item:t}});return this._store.dispatch(r),this._actions.pipe(a.ofType(this._actionTypes.PATCH_SUCCESS,this._actionTypes.PATCH_FAILURE),u.filter(function(t){return t.uuid===r.uuid})).pipe(u.switchMap(function(){return e._store}),l.select(l.createSelector(this._modelState,function(t){return t.patch})),u.map(function(t){return t.find(function(t){return t.uuid===r.uuid})}),u.filter(function(t){return null!=t}),u.tap(function(t){null!=t.error&&o.throwError(t.error)}),u.filter(function(t){return null!=t.object}),u.map(function(t){return t.object}))},kt.prototype.delete=function(t){var e=this,r=qt({type:this._actionTypes.DELETE,payload:{item:t}});return this._store.dispatch(r),this._actions.pipe(a.ofType(this._actionTypes.DELETE_SUCCESS,this._actionTypes.DELETE_FAILURE),u.filter(function(t){return t.uuid===r.uuid})).pipe(u.switchMap(function(){return e._store}),l.select(l.createSelector(this._modelState,function(t){return t.delete})),u.map(function(t){return t.find(function(t){return t.uuid===r.uuid})}),u.filter(function(t){return null!=t}),u.tap(function(t){null!=t.error&&o.throwError(t.error)}),u.filter(function(t){return null!=t.object}),u.map(function(t){return t.object}))},kt.prototype.deleteAll=function(t){var e=this,r=qt({type:this._actionTypes.DELETE_ALL,payload:{items:t}});return this._store.dispatch(r),this._actions.pipe(a.ofType(this._actionTypes.DELETE_ALL_SUCCESS,this._actionTypes.DELETE_ALL_FAILURE),u.filter(function(t){return t.uuid===r.uuid})).pipe(u.switchMap(function(){return e._store}),l.select(l.createSelector(this._modelState,function(t){return t.deleteAll})),u.map(function(t){return t.find(function(t){return t.uuid===r.uuid})}),u.filter(function(t){return null!=t}),u.tap(function(t){null!=t.error&&o.throwError(t.error)}),u.filter(function(t){return null!=t.objects}),u.map(function(t){return t.objects}))},kt.prototype.query=function(t){var e=this,r=qt({type:this._actionTypes.QUERY,payload:{params:t||{}}});return this._store.dispatch(r),this._actions.pipe(a.ofType(this._actionTypes.QUERY_SUCCESS,this._actionTypes.QUERY_FAILURE),u.filter(function(t){return t.uuid===r.uuid})).pipe(u.switchMap(function(){return e._store}),l.select(l.createSelector(this._modelState,function(t){return t.query})),u.map(function(t){return t.find(function(t){return t.uuid===r.uuid})}),u.filter(function(t){return null!=t}),u.tap(function(t){null!=t.error&&o.throwError(t.error)}),u.filter(function(t){return null!=t.objects}),u.map(function(t){return t.objects}))},kt);function kt(t,e,r,n){this._store=t,this._actions=e,this._actionTypes=r;var i=l.createFeatureSelector(n[0]);this._modelState=l.createSelector(i,function(t){return t[n[1]]}),this._lastGetEntry=o.pipe(l.select(l.createSelector(this._modelState,function(t){return t.get})),u.filter(function(t){return 0<t.length}),u.map(function(t){return t[0]})),this._lastListEntry=o.pipe(l.select(l.createSelector(this._modelState,function(t){return t.list})),u.filter(function(t){return 0<t.length}),u.map(function(t){return t[0]})),this._lastCreateEntry=o.pipe(l.select(l.createSelector(this._modelState,function(t){return t.create})),u.filter(function(t){return 0<t.length}),u.map(function(t){return t[0]})),this._lastPatchEntry=o.pipe(l.select(l.createSelector(this._modelState,function(t){return t.patch})),u.filter(function(t){return 0<t.length}),u.map(function(t){return t[0]})),this._lastUpdateEntry=o.pipe(l.select(l.createSelector(this._modelState,function(t){return t.update})),u.filter(function(t){return 0<t.length}),u.map(function(t){return t[0]})),this._lastDeleteEntry=o.pipe(l.select(l.createSelector(this._modelState,function(t){return t.delete})),u.filter(function(t){return 0<t.length}),u.map(function(t){return t[0]})),this._lastDeleteAllEntry=o.pipe(l.select(l.createSelector(this._modelState,function(t){return t.deleteAll})),u.filter(function(t){return 0<t.length}),u.map(function(t){return t[0]})),this._lastQueryEntry=o.pipe(l.select(l.createSelector(this._modelState,function(t){return t.query})),u.filter(function(t){return 0<t.length}),u.map(function(t){return t[0]}))}t.MODEL_OPTIONS=$t,t.ModelActions=Pt,t.ModelEffects=Gt,t.ModelGenericAction=Qt,t.ModelManager=Ht,t.ModelService=Nt,t.createAction=qt,t.generateInitialModelState=Ft,t.modelReducer=Ot,t.reducers=xt,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=core-model.umd.min.js.map
